(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8224],{1260:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5155),n=s(2115),l=s(7347);function a(e){let{columns:t,data:s,pageSize:a=8,searchable:i=!0}=e,[o,d]=(0,n.useState)(1),[c,u]=(0,n.useState)(null),[x,m]=(0,n.useState)("asc"),[h,p]=(0,n.useState)(""),f=(0,n.useMemo)(()=>{let e=h.trim().toLowerCase(),t=s;return e&&(t=t.filter(t=>Object.values(t).some(t=>String(t).toLowerCase().includes(e)))),c&&(t=[...t].sort((e,t)=>{let s=e[c],r=t[c];return s===r?0:"asc"===x?String(s)>String(r)?1:-1:String(s)<String(r)?1:-1})),t},[s,h,c,x]),b=Math.max(1,Math.ceil(f.length/a)),g=(o-1)*a,j=f.slice(g,g+a);return(0,r.jsxs)("div",{className:"w-full",children:[i&&(0,r.jsx)("div",{className:"mb-2 flex items-center",children:(0,r.jsxs)("div",{className:"relative w-full max-w-xs",children:[(0,r.jsx)(l.In,{icon:"mdi:magnify",width:18,className:"absolute left-2 top-1/2 -translate-y-1/2 text-neutral-500"}),(0,r.jsx)("input",{value:h,onChange:e=>{p(e.target.value),d(1)},placeholder:"Search…",className:"pl-7 pr-2 py-1.5 text-sm rounded-md border border-neutral-200/70 bg-white/80 w-full"})]})}),(0,r.jsx)("div",{className:"overflow-auto border border-neutral-200/70 rounded-lg",children:(0,r.jsxs)("table",{className:"min-w-full text-sm",children:[(0,r.jsx)("thead",{className:"bg-neutral-50",children:(0,r.jsx)("tr",{children:t.map(e=>(0,r.jsx)("th",{className:"text-left font-normal px-3 py-2 border-b border-neutral-200/70",children:(0,r.jsxs)("button",{className:"inline-flex items-center gap-1 hover:underline",onClick:()=>{c===e.key&&m(e=>"asc"===e?"desc":"asc"),u(e.key)},children:[(0,r.jsx)("span",{children:e.header}),c===e.key&&(0,r.jsx)(l.In,{icon:"asc"===x?"mdi:arrow-up":"mdi:arrow-down",width:14})]})},String(e.key)))})}),(0,r.jsx)("tbody",{children:j.map((e,s)=>(0,r.jsx)("tr",{className:"odd:bg-white even:bg-neutral-50/60",children:t.map(t=>{var s;return(0,r.jsx)("td",{className:"px-3 py-2 border-b border-neutral-200/60",children:t.render?t.render(e):String(null!=(s=e[t.key])?s:"")},String(t.key))})},s))})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,r.jsxs)("p",{className:"text-xs text-neutral-500",children:["Page ",o," of ",b]}),(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)("button",{className:"px-2 py-1 text-xs rounded border border-neutral-200/70",disabled:1===o,onClick:()=>d(e=>Math.max(1,e-1)),children:"Prev"}),(0,r.jsx)("button",{className:"px-2 py-1 text-xs rounded border border-neutral-200/70",disabled:o===b,onClick:()=>d(e=>Math.min(b,e+1)),children:"Next"})]})]})]})}},3187:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var r=s(5155),n=s(6310),l=s(5886),a=s(1260),i=s(2115),o=s(9984),d=s(7347),c=s(9114),u=s(5206),x=s(6874),m=s.n(x);function h(){let[e,t]=(0,i.useState)(""),[s,x]=(0,i.useState)(null),[h,p]=(0,i.useState)(""),[f,b]=(0,i.useState)([]),[g,j]=(0,i.useState)(!1),[v,N]=(0,i.useState)(null),[w,y]=(0,i.useState)(null),S=(0,i.useRef)(null);async function C(){let e=(await o.G.bulkJobs.list()).map(e=>({id:String(e.id),name:String(e.name||"Job ".concat(e.id.slice(0,6))),status:String(e.status),created_at:String(e.created_at||new Date().toISOString()),total_rows:Number(e.total_rows||0),success_count:Number(e.success_count||0),fail_count:Number(e.fail_count||0),result_url:e.result_url,errors:e.errors||[],report_ids:e.report_ids||[]}));return b(e),e}(0,i.useEffect)(()=>(C(),()=>{S.current&&clearInterval(S.current)}),[]);let k=async()=>{if(!s)return void N("Please choose a file");j(!0),N(null);try{let e=await o.G.files.upload(s);if(!e.success)throw Error("Upload failed");await o.G.bulkJobs.create(e.url,h||void 0),N("Job started. Tracking progress…"),t(""),x(null),p(""),await C(),S.current||(S.current=setInterval(async()=>{!(await C()).some(e=>"completed"!==e.status)&&S.current&&(clearInterval(S.current),S.current=null)},2e3))}catch(e){N(e.message)}finally{j(!1)}},_=f.filter(e=>"completed"!==e.status).length;return(0,r.jsx)(n.A,{allowedRoles:["user"],children:(0,r.jsxs)(l.A,{title:"Bulk Upload",subtitle:"Upload CSV/Excel for mass vendor verification and track job status",children:[(0,r.jsxs)("div",{className:"mb-6 rounded-xl border border-neutral-200/70 bg-white p-5 shadow-sm",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-sm font-semibold text-neutral-900 mb-2",style:{fontFamily:"var(--font-geist)"},children:"CSV Format Requirements"}),(0,r.jsxs)("p",{className:"text-xs text-neutral-600 mb-3",children:["Your CSV file must include the following columns: ",(0,r.jsx)("code",{className:"bg-neutral-100 px-1.5 py-0.5 rounded",children:"vendorName"}),", ",(0,r.jsx)("code",{className:"bg-neutral-100 px-1.5 py-0.5 rounded",children:"gstin"}),", ",(0,r.jsx)("code",{className:"bg-neutral-100 px-1.5 py-0.5 rounded",children:"pan"}),", ",(0,r.jsx)("code",{className:"bg-neutral-100 px-1.5 py-0.5 rounded",children:"bankAccount"}),", ",(0,r.jsx)("code",{className:"bg-neutral-100 px-1.5 py-0.5 rounded",children:"ifsc"})]})]}),(0,r.jsxs)("button",{onClick:()=>{let e=new Blob(["vendorName,gstin,pan,bankAccount,ifsc\nShree Logistics Pvt Ltd,27AABCU9603R1ZX,AAABCU9603R,HDFC0001234,1234567890\nApex Supplies,29ABCDE1234F1Z5,ABCDE1234F,SBIN0007654,9876543210"],{type:"text/csv"}),t=URL.createObjectURL(e),s=document.createElement("a");s.href=t,s.download="bulk_verification_sample.csv",s.click(),URL.revokeObjectURL(t)},className:"flex items-center gap-2 px-3 py-2 rounded-lg border border-neutral-200 text-sm font-medium text-neutral-700 hover:bg-neutral-50 transition",children:[(0,r.jsx)(d.In,{icon:"mdi:download",width:18}),"Download Sample CSV"]})]}),(0,r.jsx)("div",{className:"bg-neutral-50 rounded-lg p-3 font-mono text-xs overflow-x-auto",children:(0,r.jsx)("pre",{children:"vendorName,gstin,pan,bankAccount,ifsc\nShree Logistics Pvt Ltd,27AABCU9603R1ZX,AAABCU9603R,1234567890,HDFC0001234\nApex Supplies,29ABCDE1234F1Z5,ABCDE1234F,9876543210,SBIN0007654"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-6",children:[(0,r.jsxs)("div",{className:"md:col-span-2 rounded-lg border border-neutral-200/70 bg-white/80 p-4",children:[(0,r.jsx)("p",{className:"text-sm mb-4",style:{fontFamily:"var(--font-geist)",fontWeight:600},children:"Upload file"}),(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsx)("label",{className:"block text-xs text-neutral-600 mb-1",children:"Job Name (optional)"}),(0,r.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"e.g., Q3 Vendor Verification",className:"w-full px-3 py-2 rounded-md border border-neutral-200/70 text-sm"})]}),(0,r.jsxs)("label",{className:"inline-flex items-center gap-2 px-3 py-2 rounded-md border border-neutral-200/70 cursor-pointer bg-white/90 hover:bg-neutral-50 transition",children:[(0,r.jsx)(d.In,{icon:"mdi:file-upload-outline",width:18}),(0,r.jsx)("input",{type:"file",accept:".csv,.xlsx,.xls",className:"hidden",onChange:e=>{var s;let r=Array.from(null!=(s=e.target.files)?s:[])[0];x(null!=r?r:null),t((null==r?void 0:r.name)||"")}}),(0,r.jsx)("span",{children:"Choose File"})]}),e&&(0,r.jsxs)("p",{className:"text-xs mt-2 text-green-600",children:["Selected: ",e]}),(0,r.jsx)("div",{className:"mt-3",children:(0,r.jsx)("button",{disabled:g||!s,onClick:k,className:"px-4 py-2 text-sm rounded-md text-white bg-orange-600 disabled:opacity-50 hover:shadow-lg transition",children:g?"Starting…":"Start Job"})}),v&&(0,r.jsx)("p",{className:"text-xs mt-2 ".concat(v.includes("started")?"text-green-600":"text-red-600"),children:v})]}),(0,r.jsxs)("div",{className:"rounded-lg border border-neutral-200/70 bg-white/80 p-4",children:[(0,r.jsx)("p",{className:"text-sm mb-3",style:{fontFamily:"var(--font-geist)",fontWeight:600},children:"Active Jobs"}),_>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-xs text-neutral-600 mb-1",children:[(0,r.jsx)("span",{children:"Processing..."}),(0,r.jsxs)("span",{children:[_," active"]})]}),(0,r.jsx)("div",{className:"w-full h-2 rounded bg-neutral-200 overflow-hidden",children:(0,r.jsx)("div",{className:"h-2 bg-orange-500 animate-pulse",style:{width:"66%"}})})]}),(0,r.jsxs)("p",{className:"text-xs text-neutral-500",children:["Total jobs: ",f.length]})]})]}),f.length>0&&(0,r.jsx)("div",{className:"rounded-xl border border-neutral-200/70 bg-white shadow-sm overflow-hidden",children:(0,r.jsx)(a.A,{columns:[{key:"name",header:"Job Name"},{key:"created_at",header:"Created At",render:e=>new Date(e.created_at).toLocaleString("en-IN",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},{key:"status",header:"Status",render:e=>(0,r.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("completed"===e.status?"bg-green-100 text-green-700":"processing"===e.status?"bg-blue-100 text-blue-700":"failed"===e.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:e.status})},{key:"total_rows",header:"Total Rows"},{key:"success_count",header:"Success"},{key:"fail_count",header:"Failed"},{key:"id",header:"Action",render:e=>(0,r.jsx)("button",{onClick:()=>y(e),className:"text-sm text-orange-600 hover:text-orange-700 font-medium",children:"View Details"})}],data:f})}),(0,r.jsx)(c.N,{children:w&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>y(null),className:"fixed inset-0 bg-black/30 z-50"}),(0,r.jsx)(u.P.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[80vh] overflow-y-auto",children:[(0,r.jsxs)("div",{className:"sticky top-0 bg-white border-b border-neutral-200 px-6 py-4 flex items-center justify-between",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-neutral-900",style:{fontFamily:"var(--font-geist)"},children:["Job Details: ",w.name]}),(0,r.jsx)("button",{onClick:()=>y(null),className:"p-2 hover:bg-neutral-100 rounded-lg transition",children:(0,r.jsx)(d.In,{icon:"mdi:close",width:20})})]}),(0,r.jsxs)("div",{className:"p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-neutral-500 mb-1",children:"Status"}),(0,r.jsx)("p",{className:"text-sm font-medium text-neutral-900",children:w.status})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-neutral-500 mb-1",children:"Created At"}),(0,r.jsx)("p",{className:"text-sm font-medium text-neutral-900",children:new Date(w.created_at).toLocaleString("en-IN")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-neutral-500 mb-1",children:"Total Rows"}),(0,r.jsx)("p",{className:"text-sm font-medium text-neutral-900",children:w.total_rows})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-neutral-500 mb-1",children:"Success / Failed"}),(0,r.jsxs)("p",{className:"text-sm font-medium text-neutral-900",children:[(0,r.jsx)("span",{className:"text-green-600",children:w.success_count})," / ",(0,r.jsx)("span",{className:"text-red-600",children:w.fail_count})]})]})]}),w.errors&&w.errors.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-neutral-900 mb-2",children:"Errors"}),(0,r.jsx)("div",{className:"space-y-2",children:w.errors.map((e,t)=>(0,r.jsxs)("div",{className:"p-3 rounded-lg bg-red-50 border border-red-100",children:[(0,r.jsxs)("p",{className:"text-xs font-medium text-red-900",children:["Row ",e.row,": ",e.vendor]}),(0,r.jsx)("p",{className:"text-xs text-red-700 mt-1",children:e.error})]},t))})]}),w.report_ids&&w.report_ids.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("p",{className:"text-sm font-semibold text-neutral-900 mb-2",children:["Generated Reports (",w.report_ids.length,")"]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[w.report_ids.slice(0,6).map(e=>(0,r.jsx)(m(),{href:"/dashboard/reports/".concat(e),className:"p-2 rounded-lg border border-neutral-200 hover:bg-neutral-50 text-xs text-neutral-700 hover:text-orange-600 transition",children:e},e)),w.report_ids.length>6&&(0,r.jsxs)("p",{className:"p-2 text-xs text-neutral-500",children:["+",w.report_ids.length-6," more reports"]})]})]}),w.result_url&&(0,r.jsx)("div",{className:"pt-4 border-t border-neutral-100",children:(0,r.jsxs)("a",{href:w.result_url,className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-to-r from-orange-500 to-blue-600 text-white text-sm font-medium hover:shadow-lg transition",children:[(0,r.jsx)(d.In,{icon:"mdi:download",width:18}),"Download Results CSV"]})})]})]})})]})})]})})}},6967:(e,t,s)=>{Promise.resolve().then(s.bind(s,3187))},9114:(e,t,s)=>{"use strict";s.d(t,{N:()=>j});var r=s(5155),n=s(2115),l=s(869),a=s(2885),i=s(7494),o=s(845),d=s(7351),c=s(1508);function u(e,t){if("function"==typeof e)return e(t);null!=e&&(e.current=t)}class x extends n.Component{getSnapshotBeforeUpdate(e){let t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){let e=t.offsetParent,s=(0,d.s)(e)&&e.offsetWidth||0,r=this.props.sizeRef.current;r.height=t.offsetHeight||0,r.width=t.offsetWidth||0,r.top=t.offsetTop,r.left=t.offsetLeft,r.right=s-r.width-r.left}return null}componentDidUpdate(){}render(){return this.props.children}}function m(e){let{children:t,isPresent:s,anchorX:l,root:a}=e,i=(0,n.useId)(),o=(0,n.useRef)(null),d=(0,n.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:m}=(0,n.useContext)(c.Q),h=function(...e){return n.useCallback(function(...e){return t=>{let s=!1,r=e.map(e=>{let r=u(e,t);return s||"function"!=typeof r||(s=!0),r});if(s)return()=>{for(let t=0;t<r.length;t++){let s=r[t];"function"==typeof s?s():u(e[t],null)}}}}(...e),e)}(o,null==t?void 0:t.ref);return(0,n.useInsertionEffect)(()=>{let{width:e,height:t,top:r,left:n,right:c}=d.current;if(s||!o.current||!e||!t)return;o.current.dataset.motionPopId=i;let u=document.createElement("style");m&&(u.nonce=m);let x=null!=a?a:document.head;return x.appendChild(u),u.sheet&&u.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat("left"===l?"left: ".concat(n):"right: ".concat(c),"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{x.contains(u)&&x.removeChild(u)}},[s]),(0,r.jsx)(x,{isPresent:s,childRef:o,sizeRef:d,children:n.cloneElement(t,{ref:h})})}let h=e=>{let{children:t,initial:s,isPresent:l,onExitComplete:i,custom:d,presenceAffectsLayout:c,mode:u,anchorX:x,root:h}=e,f=(0,a.M)(p),b=(0,n.useId)(),g=!0,j=(0,n.useMemo)(()=>(g=!1,{id:b,initial:s,isPresent:l,custom:d,onExitComplete:e=>{for(let t of(f.set(e,!0),f.values()))if(!t)return;i&&i()},register:e=>(f.set(e,!1),()=>f.delete(e))}),[l,f,i]);return c&&g&&(j={...j}),(0,n.useMemo)(()=>{f.forEach((e,t)=>f.set(t,!1))},[l]),n.useEffect(()=>{l||f.size||!i||i()},[l]),"popLayout"===u&&(t=(0,r.jsx)(m,{isPresent:l,anchorX:x,root:h,children:t})),(0,r.jsx)(o.t.Provider,{value:j,children:t})};function p(){return new Map}var f=s(2082);let b=e=>e.key||"";function g(e){let t=[];return n.Children.forEach(e,e=>{(0,n.isValidElement)(e)&&t.push(e)}),t}let j=e=>{let{children:t,custom:s,initial:o=!0,onExitComplete:d,presenceAffectsLayout:c=!0,mode:u="sync",propagate:x=!1,anchorX:m="left",root:p}=e,[j,v]=(0,f.xQ)(x),N=(0,n.useMemo)(()=>g(t),[t]),w=x&&!j?[]:N.map(b),y=(0,n.useRef)(!0),S=(0,n.useRef)(N),C=(0,a.M)(()=>new Map),[k,_]=(0,n.useState)(N),[A,R]=(0,n.useState)(N);(0,i.E)(()=>{y.current=!1,S.current=N;for(let e=0;e<A.length;e++){let t=b(A[e]);w.includes(t)?C.delete(t):!0!==C.get(t)&&C.set(t,!1)}},[A,w.length,w.join("-")]);let E=[];if(N!==k){let e=[...N];for(let t=0;t<A.length;t++){let s=A[t],r=b(s);w.includes(r)||(e.splice(t,0,s),E.push(s))}return"wait"===u&&E.length&&(e=E),R(g(e)),_(N),null}let{forceRender:I}=(0,n.useContext)(l.L);return(0,r.jsx)(r.Fragment,{children:A.map(e=>{let t=b(e),n=(!x||!!j)&&(N===A||w.includes(t));return(0,r.jsx)(h,{isPresent:n,initial:(!y.current||!!o)&&void 0,custom:s,presenceAffectsLayout:c,mode:u,root:p,onExitComplete:n?void 0:()=>{if(!C.has(t))return;C.set(t,!0);let e=!0;C.forEach(t=>{t||(e=!1)}),e&&(null==I||I(),R(S.current),x&&(null==v||v()),d&&d())},anchorX:m,children:e},t)})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5206,7347,6874,8231,8441,1684,7358],()=>t(6967)),_N_E=e.O()}]);